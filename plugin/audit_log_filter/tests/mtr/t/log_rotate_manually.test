
SELECT audit_log_filter_set_filter('log_general', '{"filter": {"class": {"name": "general"}}}');
SELECT audit_log_filter_set_user('%', 'log_general');

--source clean_current_audit_log.inc
--source generate_audit_events.inc

SELECT audit_log_rotate();

--source generate_audit_events.inc

SELECT audit_log_rotate();

--let $log_path = `SELECT @@global.datadir`

# There is no closing XML tag in current log file while the server is working
--source include/shutdown_mysqld.inc
--source check_rotated_logs.inc
--source include/start_mysqld.inc

--echo #
--echo # Cleanup
DELETE FROM mysql.audit_log_user;
DELETE FROM mysql.audit_log_filter;
SELECT audit_log_filter_flush();
